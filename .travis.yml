language: ruby
rvm:
- 2.0.0
services:
- memcache
- redis-server
script:
- bundle exec rake spec
- bundle exec rake karma:run
- bundle exec rubocop -R
before_script:
- npm install
- psql -c 'create database mpdx_test;' -U postgres
- cp config/database.travis.yml config/database.yml
- cp config/config.travis.yml config/config.yml
- bundle exec rake db:schema:load RAILS_ENV=test
branches:
  only:
  - master
deploy:
  provider: opsworks
  access-key-id: AKIAJNKHB3Q5LKUKC2QQ
  secret-access-key: AJ36erexwgSMOGeCHMCMrd9HUc3C2f5fCB+PzDk/tADnsSSgMqasNBQomrp4ofmB8Hi/flzUWjS6VKrEJibRAtFc7LKctoXGJYgM7Yo9awdSOtDecWW9LwRzmuhGK1UlQZcvsoOTActT0BW5Em9RElplPWAe4P5Ae4OjsluHhoE=
  app-id: 36c106d9-e3c9-495c-a826-1e29854d12c7
  on: master
