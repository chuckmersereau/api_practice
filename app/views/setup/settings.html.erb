<h1><%= _('Finally, a few questions to get you set up&hellip;') %></h1>
<%= form_for @preference_set, url: preference_path(current_user, redirect: setup_path(:finish)), method: :put do |f| %>
  <%= f.hidden_field(:preferences_prefills, value: @preferences_prefills.to_json) %>
  <%= f.hidden_field(:account_list_organizations, value: @account_list_organizations.to_json) %>
  <% if @account_list_organizations.count > 1 %>
    <div class="wizard-question form-group">
      <%= f.label :default_account_list, _('Default Account List') %>
      <%= f.select :default_account_list, current_user.account_lists.collect { |al| [al.name, al.id] }, {},
                   {class: 'form-control'} %>
    </div>
  <% end %>

  <% if @preferences_prefills.count > 1 %>
    <div class="wizard-question form-group">
      <%= label_tag :prefill_options, _('Default Organization') %>
      <p><%= _("We'll use this to prefill some questions below") %></p>
      <%= select :preferences, :prefill_options, @account_list_organizations.first[1], {},
                   {class: 'form-control'} %>
    </div>
  <% end %>

  <div class="wizard-question form-group">
    <%= f.label(:home_country, _('Default Supporter Country')) %>
    <%= f.text_field :home_country, class: 'form-control ui-autocomplete-input' %>
  </div>
  <% if $rollout.active?(:currencies, current_account_list) %>
    <div class="row padding-top">
      <div class="col-sm-12">
        <div class="wizard-question form-group">
          <%= f.label :currency, _('Default Currency') %>
          <p><%= _('We will convert donations and your account balance into this currency') %></p>
          <%= f.select :currency, currency_select, {prompt: current_currency ? current_currency : 'USD'}, {class: 'form-control'} %>
        </div>
      </div>
    </div>
  <% end %>


  <div class="wizard-question form-group">
    <%= f.label :monthly_goal, _('Monthly Goal') %>
    <div class="input-group">
      <span class="input-group-addon goal-currency-symbol">$</span>
      <%= f.text_field :monthly_goal, class: 'form-control', placeholder: _('In USD') %>
    </div>
  </div>

  <div class="wizard-question form-group">
    <%= f.label :locale, _('Language') %>
    <%= f.select :locale, TwitterCldr::Shared::Languages.all_for(locale)
        .select { |k, _| TwitterCldr.supported_locales.include?(k) }.invert,
                 {selected: locale}, {class: 'form-control'} %>
  </div>

  <div class="wizard-question form-group">
    <%= f.label :time_zone, _('Time zone') %>
    <%= f.time_zone_select :time_zone, nil, {}, {:class => 'form-control'} %>
  </div>

  <div class="row wizard-question form-group">
    <div class="col-sm-8">
      <%= label_tag _('Email Notification Settings') %>
      <p><%= _('Receive email updates when events like missed gifts or special contributions.') %></p>
    </div>
    <div class="col-sm-4">
      <div class="btn-group" data-toggle="buttons">
        <%= f.label :notification_settings, _('Default'), value: 'default', class: 'btn btn-default active' do %>
          <%= f.radio_button :notification_settings, 'default', checked: true %> <%= _('Default') %>
        <% end %>
        <%= f.label :notification_settings, _('None'), value: 'none', class: 'btn btn-default' do %>
          <%= f.radio_button :notification_settings, 'none' %> <%= _('None') %>
        <% end %>
      </div>
    </div>
  </div>

  <div>
    <%= f.submit _('Save Preferences'), class: 'btn btn-primary' %>
  </div>
<% end %>
