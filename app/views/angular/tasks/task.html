<td class="check">
    <a name="task_{{task.id}}"/>
    <input type="checkbox" name="task_ids[]" value="{{task.id}}" data-behavior="complete_task" data-results="{{completeOptions.join()}}" data-id="{{task.id}}" data-title="{{task.activity_type + ' ' + task.subject}}" />
</td>
<td class="data">
    <div class="primary">
        <i class="fa fa-lg fav" ng-class="{'fa-star-o': !task.starred, 'fa-star': task.starred}" ng-click="starTask()"></i>
        <a class="comment_status" href="" ng-click="visibleComments=!visibleComments; visibleContactInfo=false"><span id="comment_count_2">{{task.comments.length}}</span></a>

        <div class="actions">
            <a class="ico ico_edit edit_task" data-id="{{task.id}}" data-remote="true" ng-href="/tasks/{{task.id}}/edit">Edit</a>
            <a class="ico ico_trash" data-confirm="Are you sure you want to delete this task instead of marking it as completed?" data-method="delete" data-remote="true" ng-href="/tasks/{{task.id}}" rel="nofollow">Delete</a>
        </div>
        <span ng-hide="task.activity_type === ''">{{task.activity_type}} -</span>
        <strong><span class="tasktitle">{{task.subject}}</span></strong> - {{task.due_date | ignoreTimezone | date:'MM/dd/yyyy, h:mma'}}

        <div style="display:inline" class="tags">
            <a class="tag" ng-repeat-start="tag in task.tag_list">{{tag}}</a>
            <span ng-repeat-end> </span>
        </div>
        <span class="people" ng-show="task.contacts.length > 0">(<span ng-repeat="contact in task.contacts"><span ng-show="!$first">, </span><a ng-click="showContactInfo(contact)" ng-bind="contacts[contact]" href="" title="Click to view contact details"></a></span>)</span>
    </div>

    <div ng-show="visibleContactInfo" class="contact-info">
        <a class="corner_close" href="" ng-click="visibleContactInfo=false">close</a>
        <h2><a ng-href="/contacts/{{contactInfo.contact.id}}">{{contactInfo.contact.name}}</a></h2>
        <div class="column">
            <p ng-repeat="address in contactInfo.addresses">
                <strong>{{address.location}} Address</strong> <i class="fa fa-check green" ng-show="address.primary_mailing_address"></i>
                <br>
                {{address.street}}<br>{{address.city}}, {{address.state}} {{address.postal_code}} {{address.country}}
            </p>
            <p ng-show="!contactInfo.addresses.length">No mailing address</p>


            <p ng-repeat="referrer in contactInfo.contact.referrals_to_me_ids">
                <strong>Referrer:</strong><br>
                <a ng-href="/contacts/{{referrer.id}}">{{referrer.name}}</a>
            </p>
        </div>
        <div class="column">
            <p ng-repeat="phone in contactInfo.phone_numbers">
                <strong>Phone ({{phone.location}})</strong><br>
                {{phone.number}} <i class="fa fa-check green" ng-show="phone.primary"></i>
            </p>
            <p ng-show="!contactInfo.phone_numbers.length">No phone number</p>
        </div>
        <div class="column">
            <p ng-repeat="email in contactInfo.email_addresses">
                <strong>Email</strong><br>
                <a ng-href="mailto:{{email.email}}">{{email.email}}</a> <i class="fa fa-check green" ng-show="email.primary"></i>
            </p>
            <p ng-show="!contactInfo.email_addresses.length">No email address</p>
        </div>

        <div class="profile-pic">
            <img ng-src="{{contactInfo.contact.avatar}}" style="max-width:126px;">
            <div class="social">
                <a class="facebook" ng-href="http://facebook.com/profile.php?id={{account.remote_id}}" target="_blank" ng-repeat="account in contactInfo.facebook_accounts">f</a>
            </div>
        </div>
    </div>

    <div class="comments" ng-show="visibleComments">
        <div id="comment_list_2">
            <div class="comment" ng-repeat="comment in task.comments">
                <a class="corner_close" data-confirm="Are you sure?" data-method="delete" data-remote="true" data-selector=".comment" ng-href="/activity_comments/{{comment}}?activity_id={{getComment(comment).activity_id}}" rel="nofollow">delete</a>
                <i class="fa fa-comments-o fa-lg pull-left"></i>

                <div class="body">
                    <a ng-href="/people/{{getComment(comment).person_id}}">{{getPerson(getComment(comment).person_id).name}}</a>
                    <p ng-bind="getComment(comment).body"></p>
                </div>
                <span class="time">{{getComment(comment).created_at | date:'MM/dd/yyyy, h:mma'}}</span>
            </div>
        </div>

        <div class="comment_form">
            <form ng-submit="postNewComment()">
                <div style="margin:0;padding:0;display:inline"></div>
                <textarea ng-model="postNewCommentMsg"></textarea>

                <div class="buttons">
                    <button class="btn smallbtn">Add Comment</button>
                </div>
            </form>
        </div>
    </div>
</td>