<td class="check task-check" ng-show="!task.completed">
    <i class="fa fa-lg fa-square-o complete_task" data-behavior="complete_task" data-results="{{completeResultOptions.join()}}"  data-actions="{{completeActionOptions.join()}}" data-id="{{task.id}}" data-title="{{task.activity_type + ' ' + task.subject}}"></i>
</td>
<td class="task-favorite">
    <i class="fa fa-lg fav" ng-click="starTask()" ng-hide="task.completed" ng-class="{'fa-star-o': !task.starred, 'fa-star': task.starred}"></i>
</td>
<td class="data">
    <div class="primary">

        <a ng-hide="task.activity_type === ''" class="edit_task" data-id="{{task.id}}" data-remote="true" ng-href="/tasks/{{task.id}}/edit">{{task.activity_type}}</a>
        <strong><a class="tasktitle edit_task" data-id="{{task.id}}" data-remote="true" ng-href="/tasks/{{task.id}}/edit">{{task.subject}}</a></strong>
        <span ng-show="task.completed">- {{task.result}} {{task.next_action}} - {{task.completed_at | ignoreTimezone | date:'MM/dd/yyyy, h:mma'}}</span>
        <span ng-show="!task.completed">- {{task.due_date | ignoreTimezone | date:'MM/dd/yyyy, h:mma'}}</span>

        <div style="display:inline" class="tags">
            <a class="tag" ng-repeat-start="tag in task.tag_list">{{tag}}</a>
            <span ng-repeat-end> </span>
        </div>
        <span class="people" ng-show="task.contacts.length > 0">(<span ng-repeat="contact in task.contacts"><span ng-show="!$first">, </span><a ng-click="showContactInfo(contact); $event.preventDefault();" ng-bind="contacts[contact]" href="/contacts/{{contact}}" title="Click to view contact details"></a></span>)</span>

        <a class="comment_status hover-show" href="" ng-click="visibleComments=!visibleComments; visibleContactInfo=false"><span id="comment_count_2">{{task.comments.length}}</span></a>

        <div class="actions hover-show">
            <a class="ico ico_trash" data-confirm="<%= _('Are you sure you want to delete this task instead of marking it as completed?') %>" data-method="delete" data-remote="true" ng-href="/tasks/{{task.id}}" rel="nofollow">Delete</a>
        </div>
    </div>

    <div ng-show="visibleContactInfo" class="contact-info">
        <div class="row">
            <div class="col-md-11">
                <h4><a ng-href="/contacts/{{contactInfo.contact.id}}" target="_blank">{{contactInfo.contact.name}}</a></h4>
            </div>
            <div class="col-md-1">
                <a class="corner_close" href="" ng-click="visibleContactInfo=false">close</a>
            </div>
        </div>
        <div class="row contact-task-address">
            <div class="col-md-6">
                <p ng-repeat="address in contactInfo.addresses | filter: { historic: false }">
                    <strong>{{address.location}} Address</strong> <i class="fa fa-check green" ng-show="address.primary_mailing_address"></i>
                    <br/>
                    {{address.street}}<br/>{{address.city}}, {{address.state}} {{address.postal_code}} {{address.country}}
                </p>
                <p ng-show="!contactInfo.addresses.length">No mailing address</p>

            </div>
            <div class="col-md-6">
                <p ng-repeat="referrer in contactInfo.contact.referrals_to_me_ids">
                    <strong>Referrer:</strong><br/>
                    <a ng-href="/contacts/{{referrer.id}}">{{referrer.name}}</a>
                </p>
            </div>
        </div>
        <div class="row contact-indiv-contacts">
            <div class="col-md-6">
                <div class="small-person well clearfix"  ng-repeat="p in contactInfo.people">
                    <div class="person-external">
                      <a ng-href="/people/{{p.id}}" target="_blank">
                        <img alt="Avatar" class="person_avatar" ng-src="{{p.avatar}}">
                      </a>
                      <div class="social-icons">
                        <a class="facebook" ng-href="http://facebook.com/profile.php?id={{account.remote_id}}" target="_blank" ng-repeat="account in p.facebook_accounts">f</a>
                      </div>
                    </div>

                    <div class="person_details">
                        <div class="name">
                            <a ng-href="/people/{{p.id}}" target="_blank">{{p.first_name}} {{p.last_name}}</a>
                        </div>
                        <div class="column-inner">
                            <p ng-repeat="phone in p.valid_numbers = (p.phone_numbers | filter:{ historic: false })">
                                <strong>Phone ({{phone.location}})</strong><br/>
                                {{phone.number}} <i class="fa fa-check green" ng-show="phone.primary"></i>
                            </p>
                            <p ng-show="!p.valid_numbers.length">No phone number</p>

                            <p>
                                <span ng-repeat="email in p.valid_emails = (p.email_addresses | filter:{ historic: false })">
                                    <a ng-href="mailto:{{email.email}}">{{email.email}}</a> <i class="fa fa-check green" ng-show="email.primary"></i><br/>
                                </span>

                                <span ng-show="!p.valid_emails.length">
                                    <%= _('No email address') %>
                                </span>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="comments" ng-show="visibleComments">
        <div id="comment_list_2">
            <div class="comment" ng-repeat="comment in task.comments">
                <a class="corner_close" data-confirm="Are you sure?" data-method="delete" data-remote="true" data-selector=".comment" ng-href="/activity_comments/{{comment}}?activity_id={{getComment(comment).activity_id}}" rel="nofollow">delete</a>
                <i class="fa fa-comments-o fa-lg pull-left comment-icon"></i>

                <div class="body">
                    <div class="comment-meta">
                        <span class="comment-person">{{getPerson(getComment(comment).person_id).name}}</strong>
                        at
                        <span class="comment-time">{{getComment(comment).created_at | date:'MM/dd/yyyy, h:mma'}}</span>
                    </div>
                    <p ng-bind="getComment(comment).body"></p>
                </div>

            </div>
        </div>

        <div class="comment_form">
            <form ng-submit="postNewComment()">
                <div style="margin:0;padding:0;display:inline"></div>
                <div class="form-group">
                    <textarea ng-model="postNewCommentMsg" class="form-control"></textarea>
                </div>

                <button class="btn btn-sm btn-secondary">Add Comment</button>
            </form>
        </div>
    </div>
</td>
<td ng-show="task.completed && multiselect"></td>
<td class="check" ng-show="multiselect">
  <input type="checkbox" name="task_ids[]" value="{{task.id}}" />
</td>
