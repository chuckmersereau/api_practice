<% if current_user.setup.count > 0 %>
  <div class="row">
    <div class="getting_started_title col-md-6 col-md-offset-3">
      <h1><%= _('Hi') %> <%= current_user.first_name %>!</h1>
      <h3><%= _("While there's a lot you can do in MPDX, here's a few easy steps to get you up and going:") %></h3>
    </div>
  </div>
<% else %>
  <h1><%= _('Hi') %> <%= current_user.first_name %>! <span class="smallhead"><%= _("Here's whats happening...") %></span></h1>
<% end %>

<div class="row">
  <% if current_user.setup.include? :import %>
    <div class="col-md-4 getting-started-panel">
      <div class="getting_started_number">1</div>
      <div class="panel panel-default">
        <div class="panel-body">
          <table>
            <tr>
              <td class="identify network_logo">
                <h3>
                  <%= image_tag("logos/tnt_logo.png", alt: 'TntMPD') %>
                  TntMPD
                </h3>
              </td>
              <td class="connections" data-behavior="account">
                <%= link_to(_('Import Tnt Contacts'), new_account_path(provider: 'tnt_import'),
                    class: "btn btn-xs btn-secondary", remote: true, behavior: "show_import") %>
              </td>
            </tr>
            <tr>
              <td class="identify network_logo">
                <%= image_tag("logos/google_logo.png", alt: 'Google') %>
              </td>
              <td class="connections" data-behavior="account">
                <% current_user.google_accounts.each do |account| %>
                  <div class="account_single">
                    <span class="account_name"><%= account %></span>
                    <% if account.token_expired? && !account.refresh_token! %>
                      <%= link_to(_('Refresh Google Account'), new_account_path(provider: :google, redirect: home_path),
                                  class: 'btn btn-xs btn-secondary desired_action') %>
                    <% else %>
                      <%= link_to('<i class="fa fa-cloud-download"></i> '.html_safe+_('Import Contacts'),
                                  new_account_path(provider: 'google_import', account_id: account.id),
                                  class: "btn btn-xs btn-secondary", remote: true, behavior: "show_import") %>
                    <% end %>
                  </div>
                <% end %>
                <%= auth_link('google') %>
              </td>
            </tr>
          </table>
        </div>
      </div>
      <h2><%= _('Import Contacts') %></h2>
    </div>
  <% end %>
  <% if current_user.setup.include? :goal %>
    <div class="col-md-4 getting-started-panel">
      <div class="getting_started_number">2</div>
      <div class="panel panel-default">
        <div class="panel-body">
          <% preference_set = PreferenceSet.new(user: current_user, account_list: current_account_list) %>
          <%= form_for preference_set, url: preference_path(current_user, redirect: home_path),
                       method: :put do |f| %>
            <div class="form-group">
              <%= f.label :monthly_goal, _('Monthly goal') %>
              <%= f.text_field :monthly_goal, class: 'form-control' %>
            </div>
            <%= f.submit _('Save'), class: 'btn btn-primary' %>
          <% end %>
          <hr>
          <%= link_to(_('Setup Notifications'), notifications_preferences_path,
                      class: 'btn btn-secondary', remote: true) %>
        </div>
      </div>
      <h2><%= _('Setup Your Support Goal And Notifications') %></h2>
    </div>
  <% end %>
  <% if current_user.setup.include? :contacts %>
    <div class="col-md-4 getting-started-panel">
      <div class="getting_started_number">3</div>
      <div class="panel panel-default">
        <div class="panel-body">
          Form here for first contact
        </div>
      </div>
      <h2><%= _('Add A Contact') %></h2>
    </div>
  <% end %>
  <% if current_user.setup.count < 2 %>
    <div class="col-md-<%= 12 - (current_user.setup.count*4) %> donations_summary_panel">
      <% cache(['donations_summary_chart', current_account_list], expires_in: 24.hours) do %>
        <div id="donations_summary_chart"></div>
        <%= render 'donations_summary_chart' %>
      <% end %>
    </div>
  <% end %>
</div>
