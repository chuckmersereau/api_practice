<%= render 'form', contact: @contact %>

<script>
  $("#contact_name").focusout(function () {
      var contactName = $(this).val();
      var lastName = contactName.substr(0, contactName.indexOf(','));
      var afterLastName = contactName.substr(contactName.indexOf(',') + 1).trim();
      var firstNames;
      if(_.contains(afterLastName, ' and ')) {
          firstNames = afterLastName.split(' and ');
      }else if(_.contains(afterLastName, ' & ')){
          firstNames = afterLastName.split(' & ');
      }else{
          firstNames = [afterLastName];
      }

      if(!$("#contact_greeting").val()){
          $("#contact_greeting").val(afterLastName);
      }

      //first person
      if(!$(".last_name").first().val()){
          $(".last_name").first().val(lastName);
      }
      if(!$(".first_name").first().val()){
          $(".first_name").first().val(firstNames[0]);
      }

      //second person
      if(firstNames.length > 1){
          if($(".last_name").length < 2){
            $('#add_person a').trigger('click');
          }
          if(!$(".last_name:eq(1)").val()){
              $(".last_name:eq(1)").val(lastName);
          }
          if(!$(".first_name:eq(1)").val()){
              $(".first_name:eq(1)").val(firstNames[1]);
          }
      }
      window.scrollTo(0,0);
  });
</script>