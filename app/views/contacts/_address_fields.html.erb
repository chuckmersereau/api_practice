<div class="well sfield address_field rs <%= 'marked_for_destruction' if builder.object.marked_for_destruction? %>"
     data-behavior="field-wrapper">
  <%= builder.hidden_field :user_changed, value: true %>
  <% if builder.object.remote_id.present? %>
    <div class="row small-gutter">
      <div class="col-xs-12">
        <%= _('From donor system. To make changes, ') %>
        <%= link_to_gmail_compose(_('click here'), target: '_blank',
                                    to: 'Cru Donation Services <donation.services@cru.org>', subject: 'Donor address change',
                                    body: exhibit(builder.object, self).address_change_email_body + current_user.first_name.to_s) %>
        <%= _(' to email donation services.') %>
        <input type="hidden" class="address_remotely_managed">
      </div>
    </div>
  <% end %>
  <div class="row small-gutter">
    <div class="col-xs-9">
      <%= builder.label :street, _('Street') %>
      <%= builder.text_area :street, rows: 2, placeholder: _('Street address'), class: 'form-control' %>
    </div>
    <div class="col-xs-3">
      <%= builder.label :location, _('Location') %>
      <%= builder.select :location, builder.object.assignable_locations.collect { |l| [_(l), l] }, {include_blank: true}, class: 'form-control' %>
    </div>
  </div>
  <div class="row small-gutter">
    <div class="col-xs-5">
      <div class="form-group">
        <%= builder.label :city, _('City') %>
        <%= builder.text_field :city, placeholder: _('City'), class: 'form-control' %>
      </div>
    </div>
    <div class="col-xs-4">
      <div class="form-group">
        <%= builder.label :state, _('State') %>
        <%= builder.text_field :state, placeholder: _('State'), class: 'form-control' %>
      </div>
    </div>
    <div class="col-xs-3">
      <div class="form-group">
        <%= builder.label :postal_code, _('Postal code') %>
        <%= builder.text_field :postal_code, placeholder: _('Postal Code'), class: 'form-control' %>
      </div>
    </div>
  </div>


  <div class="row small-gutter">
    <div class="col-xs-5">
      <div class="form-group">
        <%= builder.label :country, _('Country') %>
        <%= builder.country_select :country, nil, {include_blank: true}, {class: 'country_select form-control'} %>
      </div>
    </div>
    <div class="col-xs-4">
      <div class="form-group">
        <%= builder.label :region, _('Region') %>
        <%= builder.text_field :region, placeholder: _('Region'), class: 'form-control address_region' %>
      </div>
    </div>
    <div class="col-xs-3">
      <div class="form-group">
        <%= builder.label :metro_area, _('Metro area') %>
        <%= builder.text_field :metro_area, placeholder: _('Metro Area'), class: 'form-control address_metro_area' %>
      </div>
    </div>
  </div>


  <div class="row">
    <div class="col-xs-6">
      <div class="form-group">
        <div class="checkbox">
          <%= builder.label(:historic) do%>
            <%= builder.check_box :historic, class: 'address_historic' %>
            <%= _("Address no longer valid") %>
          <% end %>
        </div>
        <div class="checkbox">
          <%= builder.label(:primary_mailing_address) do %>
            <%= builder.check_box :primary_mailing_address, class: 'primary' %>
            <%= _("Primary Address") %>
          <% end %>
        </div>
      </div>
    </div>
    <div class="col-xs-6">
      <div class="form-group text-right">
        <%= link_to_remove_fields(builder, false, {label: _('Remove')}) %>
        <p class="status">
          <small>
            <%= builder.object.start_date ? _('Updated: ') + l(builder.object.start_date, format: :short) + '.' : '' %>
            <%= builder.object.source ? _('Source: ') + _(exhibit(builder.object, self).user_friendly_source) : '' %>
          </small>
        </p>
      </div>
    </div>
  </div>
</div>
