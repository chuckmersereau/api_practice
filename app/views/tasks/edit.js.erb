$('#edit_task_modal .form_wrapper').html('<%= j(render('tasks/modal_form')) %>')
$('#edit_task_modal').dialog({position:"center"})
$('[data-calendar-jquery]').datepicker({
  changeYear:true,
  dateFormat: 'yy-mm-dd',
  autoclose: true,
  todayHighlight: true,
  onSelect: function(response) {
    date = $.datepicker.parseDate('yy-mm-dd', response)
    var year = date.getFullYear();
    var month = date.getMonth() + 1;
    var day = date.getDate();

    if ($('[id$=start_at_1i]').length) {
      $('[id$=start_at_1i]').val(year);
      $('[id$=start_at_2i]').val(month);
      $('[id$=start_at_3i]').val(day);
    }

    if ($('[id$=completed_at_1i]').length) {
      $('[id$=completed_at_1i]').val(year);
      $('[id$=completed_at_2i]').val(month);
      $('[id$=completed_at_3i]').val(day);
    }
  }
});
if($('#modal_task_start_at_1i').length) {
  $('[data-calendar]').datepicker('setDate', $('#modal_task_start_at_1i').val() + '-' + $('#modal_task_start_at_2i').val() + '-' + $('#modal_task_start_at_3i').val());
}

if($('#modal_task_completed_at_1i').length) {
  $('[data-calendar]').datepicker('setDate', $('#modal_task_completed_at_1i').val() + '-' + $('#modal_task_completed_at_2i').val() + '-' + $('#modal_task_completed_at_3i').val());
}

$('#task_modal_form').areYouSure({
  message: '<%= _('It looks like you were editting a task. If you leave before submitting, your changes will be lost.') %>'
})
$.mpdx.autocomplete = new google.maps.places.Autocomplete($('#modal_task_location')[0])
