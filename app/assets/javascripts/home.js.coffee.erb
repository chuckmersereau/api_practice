$ ->
  if $('.home_controller')[0]?
    $(document).on 'tabsactivate', '#dash-tabs', (event, ui)->
      $.mpdx.loadDashTabData(ui.newPanel.selector)

    $.mpdx.loadDashTabData(window.location.hash)

    $('.see-all-birthdays').click ->
      $('.see-all-birthdays').hide()
      $('.birthdays-list').addClass('show_all')
      return false

    $('.late-partners-count').click ->
      $('#late-partners-dialog').dialog
        title: __('Late Partners'),
        modal:'true',
        width: '400px'
      return false;

    $(document).on 'click', '[data-behavior="show_import"]', ->
      $('#generic_dialog').html('<%= image_tag "spinner.gif" %>')
      $('#generic_dialog').dialog
        resizable: false,
        width: 400

$.mpdx.loadDashTabData = (hash) ->
  hash ||= '#dash-connect'
  $.mpdx.loadDashbaordTab(hash)

$.mpdx.loadDashbaordTab = (hash)->
  tab = hash.split('-')[1]
  if $(hash).html() == ''
    $(hash).html('<%= image_tag('spinner.gif') %>')
    $.ajax {
      url: '/home/' + tab,
      dataType: 'script'
    }
